C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE TRACK
OBJECT MODULE PLACED IN track.obj
COMPILER INVOKED BY: D:\cx\C51\BIN\C51.EXE track\track.c BROWSE DEBUG OBJECTEXTEND PRINT(.\track.lst) OBJECT(track.obj)

line level    source

   1          /*********************************************************************************************************
   2          *名称：track.c
   3          *功能：寻迹功能所用到的函数
   4          创建时间：2019/7/8
   5          修改时间：2019/7/8
   6          作者：黄彦钊
   7          *********************************************************************************************************/
   8          #include <STC12C5A.H>
   9          #include "delay/delay.h"
  10          #include "pwm/pwm.h"
  11          #include "color/color.h"
  12          #include "voice/voice.h"        
  13          #include "flame/flame.h"
  14          #include "config.h"
  15          //OUT开头的变量代表循迹模块状态
  16          sbit OUT1 = P1^0;
  17          sbit OUT2 = P1^1;
  18          sbit OUT3 = P1^2;
  19          sbit OUT4 = P1^3;
  20          sbit OUT5 = P1^4;
  21          sbit OUT6 = P1^5;
  22          sbit OUT7 = P1^6;
  23          sbit OUT  = P1;
  24          #define flag1 /*1110111*/ (OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1) 
  25          #define flag2 /*1110011或者1111011*/((OUT1==1)&&(OUT2==1)&&(OUT3==0)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OU
             -T7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==0)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==0)&&(OUT3==0)
             -&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==0)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7=
             -=1))||((OUT1==0)&&(OUT2==0)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==0)&&(OUT2==1)&&(OUT3==1)&&(
             -OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))
  26          #define flag3 /*1100111或者1101111*/((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==0)&&(OUT6==1)&&(OU
             -T7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)
             -&&(OUT4==1)&&(OUT5==0)&&(OUT6==0)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==0)&&(OUT7=
             -=1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==0)&&(OUT7==0))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(
             -OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==0))
  27          #define flag4 (OUT2==0)&&(OUT3==0)&&((OUT4==0)||(OUT5==0))
  28          #define flag5 ((OUT3==0)||(OUT4==0))&&(OUT5==0)&&(OUT6==0)
  29          #define flag6 (OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1)
  30          #define flag7 (OUT5==1)&&(OUT4==0)&&(OUT3==0)&&(OUT2==1)
  31          #define flag8 (OUT5==0)&&(OUT4==0)&&(OUT3==0)&&(OUT2==1)
  32          #define flag9 ((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(
             -OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1))//向左后转停止标准
  33          #define flag10 ((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&
             -(OUT2==1)&&(OUT3==0)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||(((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==
             -0)&&(OUT6==1)&&(OUT7==1)))//向右后转停止标准
  34          #define flag11 (OUT1==1)&&(OUT2==1)&&((OUT3==0)||(OUT4==0)||(OUT5==0))&&(OUT6==1)&&(OUT7==1)
  35          #define flag12 (OUT1==1)&&(OUT2==0)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1)
  36          #define flag13 ((OUT1==1)&&(OUT2==1)&&(OUT3==0)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&
             -(OUT2==1)&&(OUT3==0)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==0)&&(OUT3==0)&&(OUT4==1)&&(OUT5==1
             -)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==0)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))
  37          #define flag14 ((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&
             -(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==0
             -)&&(OUT6==0)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==0)&&(OUT7==1))
  38          
  39          int i=0,a=0;    //路段
  40          int term=0;        //当前执行模式
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 2   

  41          extern int left;   //左转速率
  42          extern int right;  //右转速率
  43          
  44          void run();                       //主程序启动
  45          void gohuadu();       //从华广到花都广场
  46          void gobaiyun();      //从花都广场到白云山
  47          void gohuanan();      //从白云山到华南植物园
  48          void gobuowu();       //从华南植物园到广东博物馆
  49          void gogzta();        //从广东博物馆到广州塔
  50          void gozhongs();      //从广州塔到中山纪念馆
  51          void gohuanpu();      //从中山纪念馆到黄埔军校
  52          void gochanglong();   //从黄埔军校到长隆动物园
  53          void goshanxia();         //从长隆动物园到上下九步行街
  54          void goliuxihe();         //从上下九步行街到流溪河国家森林公园
  55          void gohuanguang();   //从流溪河国家森林公园到华广
  56          void go_and_adjust(); //直走加调整
  57          void go_and_adjust1();//慢速直走加调整
  58          void go_and_adjust2();//慢速直走加调整方式2
  59          void go_and_adjust3();//慢速直走加调整方式2
  60          void goleft();   //左转
  61          void goleft1();  //左转方式2
  62          void goright();  //右转
  63          void goright1(); //右转方式2
  64          void goback1();  //后转
  65          void goback2();  //后转方式2
  66          void goback3();  //后转方式3
  67          void goback4();  //后转方式4
  68          
  69          
  70          /*******************************************************************************
  71          * 函 数 名         : init
  72          * 函数功能                 : 主函数初始化
  73          *******************************************************************************/
  74          void init()
  75          {
  76   1              Int0Init();//外部中断初始化
  77   1              Int1Init();
  78   1              UART_Init();
  79   1              Time1();
  80   1              goahead();
  81   1              delay_ms(800);
  82   1      }                                        
  83          /*******************************************************************************
  84          * 函 数 名         : run
  85          * 函数功能                 : 主函数启动
  86          *******************************************************************************/
  87          void run()
  88          {
  89   1              init();
  90   1              while(1)
  91   1              { 
  92   2           if(i==0){gohuadu();}     //从华广到花都广场
  93   2               if(i==1){gobaiyun();}    //从花都广场到白云山
  94   2               if(i==2){gohuanan();}    //从白云山到华南植物园
  95   2               if(i==3){gobuowu();}     //从华南植物园到广东博物馆
  96   2               if(i==4){gogzta();}      //从广东博物馆到广州塔
  97   2               if(i==5){gozhongs();}    //从广州塔到中山纪念馆
  98   2               if(i==6){gohuanpu();}    //从中山纪念馆到黄埔军校
  99   2               if(i==7){gochanglong();} //从黄埔军校到长隆动物园
 100   2               if(i==8){goshanxia();}   //从长隆动物园到上下九步行街
 101   2               if(i==9){goliuxihe();}   //从上下九步行街到流溪河国家森林公园
 102   2               if(i==10){gohuanguang();}//从流溪河国家森林公园到华广
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 3   

 103   2              }
 104   1      }
 105          
 106          /*******************************************************************************
 107          * 函 数 名         : gohuadu
 108          * 函数功能                 : 从华广到花都广场
 109          *******************************************************************************/
 110          void gohuadu()       
 111          {
 112   1               
 113   1               if(flag4||flag5)
 114   1               {
 115   2                 term++;
 116   2               }
 117   1               if(term==4)
 118   1               {
 119   2                 if(OUT7==0)
 120   2                {
 121   3                      term=6;
 122   3                      while(1)
 123   3                      {
 124   4                         go_and_adjust1();
 125   4                         if(flag1||flag2||flag3)
 126   4                         {
 127   5                           break;
 128   5                         }
 129   4                      }
 130   3                }
 131   2               }
 132   1               switch(term)  
 133   1               {
 134   2                  case 0:go_and_adjust1();Send_24bits(240,0,240);break;
 135   2                      case 1:term++;turnleft();delay_ms(2000);goleft(); break;// stop();delay_ms(1000);
 136   2                      case 2:go_and_adjust();break;
 137   2                      case 3:term++;turnright();delay_ms(3000);goright();break;// stop();delay_ms(1000);
 138   2                      case 4:go_and_adjust();break;
 139   2                      case 5:term++;turnleft();delay_ms(2000);goleft(); break; //stop();delay_ms(1000);
 140   2                      case 6:go_and_adjust1();break;
 141   2                      case 7:a=1;Send_24bits(0,0,0);goahead();delay_ms(1000);stop();one();i++;term=0;turnback1();delay_ms(4100
             -);goback1();break; //stop();delay_ms(1000);
 142   2               }
 143   1      }
 144          
 145          /*******************************************************************************
 146          * 函 数 名         : gobaiyun
 147          * 函数功能                 : 从华广到花都白云山
 148          *******************************************************************************/
 149          void gobaiyun()         
 150          {
 151   1               
 152   1               if(term<4)
 153   1               {
 154   2                if((flag4||flag5)==1)
 155   2                {
 156   3                  term++;
 157   3                }
 158   2               }
 159   1               if(term==4)
 160   1               {
 161   2                 if((flag11||flag3||flag2)==0)
 162   2                {
 163   3                  term++;
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 4   

 164   3                }
 165   2               }
 166   1               if(term==2)  //从花都广场到白云山的第二个路口的特殊情况
 167   1               {
 168   2               if(OUT7==0)
 169   2               {
 170   3                      term=4;
 171   3                      while(1)
 172   3                      {
 173   4                         go_and_adjust1();
 174   4                         if(flag1||flag2||flag3)
 175   4                         {
 176   5                           break;
 177   5                         }
 178   4                      }
 179   3               }
 180   2               }
 181   1               switch(term)  
 182   1               {
 183   2                  case 0:go_and_adjust1();break;
 184   2                      case 1:term++;turnleft();delay_ms(2000);goleft();break;//stop();delay_ms(1000);
 185   2                      case 2:go_and_adjust();break;
 186   2                      case 3:term++;turnright();delay_ms(3000);goright();break;//stop();delay_ms(1000);
 187   2                      case 4:go_and_adjust1();break;
 188   2                      case 5:a=2;Send_24bits(255,0,0);goahead();delay_ms(1000);stop();two();i++;term=0;turnback1();delay_ms(41
             -00);goback1();break;//stop();delay_ms(1000);
 189   2               }
 190   1      }          
 191          /*******************************************************************************
 192          * 函 数 名         : gohuanan
 193          * 函数功能                 : 从白云山到华南植物园
 194          *******************************************************************************/
 195          void gohuanan()           
 196          {
 197   1               if(term<4)
 198   1               {
 199   2                if((flag4||flag5)==1)
 200   2                {
 201   3                  term++;
 202   3                }
 203   2               }
 204   1               if(term==4)
 205   1               {
 206   2                 if((flag11||flag3||flag2)==0)
 207   2                {
 208   3                  term++;
 209   3                }
 210   2               }
 211   1               switch(term)  
 212   1               {
 213   2                  case 0:go_and_adjust1();break;
 214   2                      case 1:turnright();delay_ms(3000);goright1();term++;break;//stop();delay_ms(1000);
 215   2                      case 2:go_and_adjust();break;
 216   2                      case 3:turnleft();delay_ms(3000);goleft();term++;break;//stop();delay_ms(1000);
 217   2                      case 4:go_and_adjust1();break;             
 218   2                      case 5:a=3;Send_24bits(50,255,50);goahead();delay_ms(1000);stop();third();i++;term=0;turnback1();delay_m
             -s(4100);goback1();break;//stop();delay_ms(1000);
 219   2               }
 220   1      }        
 221          /*******************************************************************************
 222          * 函 数 名         : gobuowu
 223          * 函数功能                 : 从华南植物园到广东博物馆
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 5   

 224          *******************************************************************************/
 225          void gobuowu()  
 226          {
 227   1           
 228   1               if(term<4)
 229   1               {
 230   2                if((flag4||flag5)==1)
 231   2                {
 232   3                  term++;
 233   3                }
 234   2               }
 235   1               if(term==4)
 236   1               {
 237   2                 if((flag11||flag3||flag2)==0)
 238   2                {
 239   3                  term++;
 240   3                }
 241   2               }
 242   1               switch(term)  
 243   1               {
 244   2                  case 0:go_and_adjust1();break;
 245   2                      case 1:turnleft();delay_ms(3000);goleft();term++;break;//stop();delay_ms(1000);
 246   2                      case 2:go_and_adjust();break;
 247   2                      case 3:turnleft();delay_ms(3000);goleft();term++;break;//stop();delay_ms(1000);
 248   2                      case 4:go_and_adjust1();break;
 249   2                      case 5:a=4;Send_24bits(0,197,255);goahead();delay_ms(1000);stop();four();i++;term=0;turnback1();delay_ms
             -(4100);goback1();break;//stop();delay_ms(1000);
 250   2               }
 251   1      }       
 252          /*******************************************************************************
 253          * 函 数 名         : gogzta
 254          * 函数功能                 : 从广东博物馆到广州塔
 255          *******************************************************************************/
 256          void gogzta()     
 257          {
 258   1           
 259   1               if(term<4)
 260   1               {
 261   2                if((flag4||flag5)==1)
 262   2                {
 263   3                  term++;
 264   3                }
 265   2               }
 266   1               if(term==4)
 267   1               {
 268   2                 if((flag11||flag3||flag2)==0)
 269   2                {
 270   3                  term++;
 271   3                }
 272   2               }
 273   1               switch(term)  
 274   1               {
 275   2                  case 0:go_and_adjust1();break;
 276   2                      case 1:turnleft();delay_ms(3000);goleft();term++;break;//stop();delay_ms(1000);
 277   2                      case 2:go_and_adjust();break;
 278   2                      case 3:turnleft();delay_ms(3000);goleft();term++;break;//stop();delay_ms(1000);
 279   2                      case 4:go_and_adjust1();break;
 280   2                      case 5:a=5;Send_24bits(0,0,255);goahead();delay_ms(1000);stop();five();i++;term=0;turnback1();delay_ms(3
             -500);goback1();break;//stop();delay_ms(1000);
 281   2               }
 282   1      }       
 283          /*******************************************************************************
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 6   

 284          * 函 数 名         : gozhongs
 285          * 函数功能                 : 从广州塔到中山纪念馆
 286          *******************************************************************************/
 287          void gozhongs()
 288          {                                                                       
 289   1               if(term<4)
 290   1               {
 291   2                if(((flag4)||(flag5))==1)
 292   2                {
 293   3                  term++;
 294   3                }
 295   2               }
 296   1               if(term==4)
 297   1               {
 298   2                 if((flag11||flag3||flag2)==0)
 299   2                {
 300   3                  term++;
 301   3                }
 302   2               }
 303   1               switch(term)  
 304   1               {
 305   2                  case 0:go_and_adjust1();break;
 306   2                      case 1:turnleft();delay_ms(3000);goleft();term++;while(1){go_and_adjust1();if(flag1==1){break;}}left=45;
             -right=40;left1=1;left2=0;right1=1;right2=0;delay_ms(200);break;//广州塔的标志有问题
 307   2                      case 2:go_and_adjust3();break;
 308   2                      case 3:turnright();delay_ms(3000);goright();term++;break;
 309   2                      case 4:go_and_adjust1();break;
 310   2                      case 5:a=6;Send_24bits(255,255,100);goahead();delay_ms(1000);stop();six();i++;term=0;turnback3();delay_m
             -s(3000);goback4();break;
 311   2               }
 312   1      }        
 313          /*******************************************************************************
 314          * 函 数 名         : gohuanpu
 315          * 函数功能                 : 从中山纪念馆到黄埔军校
 316          *******************************************************************************/
 317          void gohuanpu()  
 318          {
 319   1               if(term<4)
 320   1               {
 321   2                if((flag4||flag5||((OUT4==0)&&(OUT5==0)&&(OUT3==0)))==1)
 322   2                {
 323   3                  term++;
 324   3                }
 325   2               }
 326   1               if(term==4)
 327   1               {
 328   2                 if((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))
 329   2                {
 330   3                  term++;
 331   3                }
 332   2               }
 333   1               switch(term)
 334   1               {
 335   2                  case 0:go_and_adjust2();break;
 336   2                      case 1:goahead();delay_ms(1200);while(1){goahead1();if(flag1||flag2||flag3){break;}}term++;break;
 337   2                      case 2:go_and_adjust1();break;
 338   2                      case 3:turnleft();delay_ms(3000);goleft();while(1){go_and_adjust1();if(flag1==1){break;}}term++;break;
 339   2                      case 4:go_and_adjust1();break;
 340   2                      case 5:a=7;Send_24bits(0,197,255);goahead();delay_ms(1000);stop();seven();i++;term=0;turnback3();delay_m
             -s(3000);goback4();left=39;right=45;left1=1;left2=0;right1=1;right2=0;delay_ms(400);break;
 341   2               }
 342   1      }       
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 7   

 343          /*******************************************************************************
 344          * 函 数 名         : gochanglong
 345          * 函数功能                 : 从黄埔到长隆动物园
 346          *******************************************************************************/
 347          void gochanglong()   
 348          {
 349   1           go_and_adjust2();
 350   1               
 351   1               if(term<4)
 352   1               {
 353   2                if((OUT4==0)&&(OUT3==0)&&(OUT2==0))
 354   2                {
 355   3                  term++;
 356   3                }
 357   2               }
 358   1               if(term==4)
 359   1               {
 360   2                 if((flag11||flag3||flag2)==0)
 361   2                {
 362   3                  term++;
 363   3                }
 364   2               }
 365   1               switch(term)
 366   1               {
 367   2                  case 0:break;
 368   2                      case 1:stop();delay_ms(1000);wentleft();delay_ms(1500);term++;while(1){go_and_adjust1();if(flag1){break;
             -}}break;
 369   2                      case 2:break;
 370   2                      case 3:stop();delay_ms(1000);wentleft();delay_ms(1500);term++;while(1){go_and_adjust1();if(flag1){break;
             -}}break;
 371   2                      case 4:break;
 372   2                      case 5:a=8;Send_24bits(255,0,0);goahead1();delay_ms(2000);stop();eight();turnback2();delay_ms(4500);i++;
             -term=0;goback2();break;//向左后转
 373   2               }
 374   1      }  
 375          /*******************************************************************************
 376          * 函 数 名         : goshanxia
 377          * 函数功能                 : 从长隆动物园到上下九步行街
 378          *******************************************************************************/
 379          void goshanxia() 
 380          {
 381   1           go_and_adjust1();
 382   1               if(term<6)
 383   1               {
 384   2                if((flag4||flag5)==1)
 385   2                {
 386   3                  term++;
 387   3                }
 388   2               }
 389   1               if(term==6)
 390   1               {
 391   2                 if((flag11||flag3||flag2)==0)
 392   2                {
 393   3                  term++;
 394   3                }
 395   2               }
 396   1               switch(term)
 397   1               {
 398   2                  case 0:if(OUT1==0){term=2;while(1){go_and_adjust1();if(flag1==1){break;}}}break;
 399   2                      case 1:turnleft();delay_ms(3200);term++;goleft();break;
 400   2                      case 2:break;
 401   2                      case 3:turnright();delay_ms(3200);term++;goright();break;
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 8   

 402   2                      case 4:break;
 403   2                      case 5:turnright();delay_ms(3200);term++;goright();break;
 404   2                      case 6:break;
 405   2                      case 7:a=9;Send_24bits(50,255,50);goahead();delay_ms(2000);stop();nine();turnback3();delay_ms(3000);i++;
             -term=0;goback4();break;
 406   2               }
 407   1      }  
 408          /*******************************************************************************
 409          * 函 数 名         : goliuxihe
 410          * 函数功能                 : 从上下九步行街到流溪河国家森林公园
 411          *******************************************************************************/
 412          void goliuxihe()         
 413          {
 414   1           go_and_adjust1();
 415   1               if(term<6)
 416   1               {
 417   2                if(((OUT4==0)&&(OUT3==0)&&(OUT2==0))||((OUT4==0)&&(OUT3==0)&&(OUT5==0))||((OUT4==0)&&(OUT5==0)&&(OUT6==
             -0)))
 418   2                {
 419   3                  term++;
 420   3                }
 421   2               }
 422   1               if(term==6)
 423   1               {
 424   2                 if((flag11||flag3||flag2)==0)
 425   2                {
 426   3                  term++;
 427   3                }
 428   2               }
 429   1               switch(term)
 430   1               {
 431   2                  case 0:break;
 432   2                      case 1:turnleft();delay_ms(3200);term++;goleft();break;
 433   2                      case 2:go_and_adjust2();break;
 434   2                      case 3:goahead1();delay_ms(1200);term++;while(1){go_and_adjust1();if(flag1){break;}};break;
 435   2                      case 4:break;
 436   2                      case 5:turnleft();delay_ms(2000);term++;goleft();break;
 437   2                      case 6:break;
 438   2                      case 7:stop();a=10;Send_24bits(0,0,250);ten();turnback1();delay_ms(5000);i++;term=0;goback1();break;
 439   2               }
 440   1      }       
 441          /*******************************************************************************
 442          * 函 数 名         : gohuanguang
 443          * 函数功能                 : 从流溪河国家森林公园到华广
 444          *******************************************************************************/
 445          void gohuanguang() 
 446          {
 447   1           go_and_adjust1();
 448   1               if(term<4)
 449   1               {
 450   2                if(((OUT4==0)&&(OUT3==0)&&(OUT2==0))||((OUT4==0)&&(OUT5==0)&&(OUT6==0)))
 451   2                {
 452   3                  term++;
 453   3                }
 454   2               }
 455   1               if(term==4)
 456   1               {
 457   2                 if((flag11||flag3||flag2)==0)
 458   2                {
 459   3                  term++;
 460   3                }
 461   2               }
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 9   

 462   1               switch(term)
 463   1               {
 464   2              case 0:break;
 465   2                  case 1:stop();delay_ms(1000);wentleft();delay_ms(1000);term++;while(1){go_and_adjust1();if(flag1){bre
             -ak;}};break;
 466   2                      case 2:break;
 467   2                      case 3:turnleft();delay_ms(3000);term++;goleft();break;
 468   2                      case 4:break;
 469   2                      case 5:stop();a=11;Send_24bits(240,0,240);eleven();stop();while(1);
 470   2               }
 471   1      }       
 472          /*******************************************************************************
 473          * 函 数 名         : go_and_adjust
 474          * 函数功能                 : 直线直走
 475          *******************************************************************************/
 476          void go_and_adjust() 
 477          {
 478   1           if(flag1==1)
 479   1               {
 480   2                      goahead1();
 481   2               }
 482   1               if(flag2)
 483   1               {
 484   2                  offsetright();
 485   2               }
 486   1               if(flag3||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==0)||(OUT6==0)||(OUT7==0)))
 487   1               {
 488   2                  offsetleft();
 489   2               }
 490   1      }  
 491          /*******************************************************************************
 492          * 函 数 名         : go_and_adjust1
 493          * 函数功能                 : 慢速直走加调整
 494          *******************************************************************************/
 495          void go_and_adjust1() 
 496          {
 497   1           if(flag1==1)
 498   1               {
 499   2                      goahead();
 500   2               }
 501   1               if(flag2==1)
 502   1               {
 503   2                  offsetright();
 504   2               }
 505   1               if(flag3==1)
 506   1               {
 507   2                  offsetleft();
 508   2               }
 509   1      }        
 510          /*******************************************************************************
 511          * 函 数 名         : go_and_adjust2
 512          * 函数功能                 : 慢速直走加调整
 513          *******************************************************************************/
 514          void go_and_adjust2()
 515          {
 516   1           if(flag1==1)
 517   1               {
 518   2                      goahead();
 519   2               }
 520   1               if(((OUT1==1)&&(OUT2==1)&&(OUT3==0)&&(OUT4==0)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&
             -&(OUT3==0)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==1)))
 521   1               {
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 10  

 522   2                  offsetright1();
 523   2               }
 524   1               if(((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==0)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1))||((OUT1==1)&&(OUT2==1)&
             -&(OUT3==1)&&(OUT4==1)&&(OUT5==0)&&(OUT6==1)&&(OUT7==1)))
 525   1               {
 526   2                  offsetleft1();
 527   2               }
 528   1      }  
 529          /*******************************************************************************
 530          * 函 数 名         : gobaiyun
 531          * 函数功能                 : 慢速直走加调整
 532          *******************************************************************************/
 533          void go_and_adjust3()
 534          {
 535   1           if(flag1==1)
 536   1               {
 537   2                      goahead1();
 538   2               }
 539   1               if(flag2==1)
 540   1               {
 541   2                  offsetright();
 542   2               }
 543   1               if(flag3==1)
 544   1               {
 545   2                  offsetleft();
 546   2               }
 547   1      }       
 548          /*******************************************************************************
 549          * 函 数 名         : goleft
 550          * 函数功能                 : 左转
 551          *******************************************************************************/
 552          void goleft()      
 553          {
 554   1           while(1)
 555   1               {
 556   2                turnleft();
 557   2                if(flag1||flag13)
 558   2                {
 559   3                  break;
 560   3                }
 561   2               }
 562   1               left=39;
 563   1               right=41;
 564   1               left1=1;
 565   1               left2=0;
 566   1               right1=0;
 567   1               right2=1;
 568   1               delay_ms(200); 
 569   1               left=42;
 570   1               right=42;
 571   1               left1=1;
 572   1               left2=0;
 573   1               right1=1;
 574   1               right2=0;
 575   1               delay_ms(400); 
 576   1      }                        
 577          /*******************************************************************************
 578          * 函 数 名         : goleft1
 579          * 函数功能                 : 左转方式2
 580          *******************************************************************************/
 581          /*void goleft1()
 582          {
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 11  

 583               while(1)
 584                   {
 585                    wentleft();   //小车向左前方前进
 586                    if(flag1==1)
 587                    {
 588                      break;
 589                    }
 590                   }
 591          }        */
 592            
 593          /*******************************************************************************
 594          * 函 数 名         : goright
 595          * 函数功能                 : 右转
 596          *******************************************************************************/
 597          void goright()     
 598          {
 599   1           while(1)
 600   1               {
 601   2                turnright();
 602   2                if(flag1||flag14){break;}
 603   2               }
 604   1               left=43;
 605   1               right=43;
 606   1               left1=0;
 607   1               left2=1;
 608   1               right1=1;
 609   1               right2=0;
 610   1               delay_ms(200);
 611   1               left=41;
 612   1               right=43;
 613   1               left1=1;
 614   1               left2=0;
 615   1               right1=1;
 616   1               right2=0;
 617   1               delay_ms(400);
 618   1                       
 619   1      }                                                                          
 620          /*******************************************************************************
 621          * 函 数 名         : goright
 622          * 函数功能                 : 右转方式2，出白云山的特殊情况
 623          *******************************************************************************/
 624          void goright1()  
 625          {
 626   1           while(1)
 627   1               {
 628   2                 turnright();
 629   2                 if(flag1||flag3||((OUT1==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==0)&&(OUT7==0))||((OUT1
             -==1)&&(OUT2==1)&&(OUT3==1)&&(OUT4==1)&&(OUT5==1)&&(OUT6==1)&&(OUT7==0)))
 630   2                 {
 631   3                   break;
 632   3                 }
 633   2               } 
 634   1      }  
 635          /*******************************************************************************
 636          * 函 数 名         : goback1
 637          * 函数功能                 : 后转
 638          *******************************************************************************/
 639          void goback1()     
 640          {
 641   1           while(1)
 642   1               {
 643   2                turnback1();
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 12  

 644   2                if(flag10==1)
 645   2                {
 646   3                  break;
 647   3                }
 648   2               }
 649   1               stop();
 650   1               delay_ms(600);
 651   1               while(1)
 652   1               {
 653   2                left=48;
 654   2                right=45;
 655   2                left1=0;
 656   2                left2=1;
 657   2                right1=1;
 658   2                right2=0;
 659   2                if(flag1==1)
 660   2                {break;}
 661   2               }
 662   1                left=51;
 663   1                right=54;
 664   1                left1=1;
 665   1                left2=0;
 666   1                right1=1;
 667   1                right2=0;
 668   1                delay_ms(600);
 669   1      }
 670          
 671          /*******************************************************************************
 672          * 函 数 名         : goback2
 673          * 函数功能                 : 后转方式2
 674          *******************************************************************************/
 675          void goback2()     //后转
 676          {
 677   1           while(1)
 678   1               {
 679   2                turnback2();
 680   2                if(flag9==1)
 681   2                {
 682   3                  break;
 683   3                }
 684   2               }
 685   1               stop();
 686   1               delay_ms(600);
 687   1               while(1)
 688   1               {
 689   2                left=40;
 690   2                right=57;
 691   2                left1=1;
 692   2                left2=0;
 693   2                right1=0;
 694   2                right2=1;
 695   2                if(flag1==1)
 696   2                {break;}
 697   2               }
 698   1                left=51;
 699   1                right=52;
 700   1                left1=1;
 701   1                left2=0;
 702   1                right1=1;
 703   1                right2=0;
 704   1                delay_ms(600);         
 705   1      }
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 13  

 706          
 707          /*******************************************************************************
 708          * 函 数 名         : goback3
 709          * 函数功能                 : 后转方式3
 710          *******************************************************************************/
 711          /*void goback3()
 712          {
 713               while(1)
 714                   {
 715                    turnback1();
 716                    
 717                    if(flag10||((OUT4==0)&&(OUT5==0)&&(OUT6==0)))
 718                    {
 719                      stop();
 720                          delay_ms(1000);
 721                          if(flag10)
 722                     {
 723                      left=0;
 724                      right=45;
 725                      left1=1;
 726                      left2=0;
 727                      right1=1;
 728                      right2=0;
 729                      delay_ms(400);
 730                     }
 731                          break;
 732                    }
 733                   }
 734                   
 735                   
 736          }  */
 737          
 738          /*******************************************************************************
 739          * 函 数 名         : goback4
 740          * 函数功能                 : 后转方式4
 741          *******************************************************************************/
 742          void goback4()
 743          {
 744   1           while(1)
 745   1               {
 746   2                turnback1();
 747   2                if(flag10==1)
 748   2                {
 749   3                  break;
 750   3                }
 751   2               }
 752   1               stop();
 753   1               delay_ms(600);
 754   1               while(1)
 755   1               {
 756   2                left=48;
 757   2                right=45;
 758   2                left1=0;
 759   2                left2=1;
 760   2                right1=1;
 761   2                right2=0;
 762   2                if(flag1==1)
 763   2                {break;}
 764   2               }
 765   1                left=51;
 766   1                right=52;
 767   1                left1=1;
C51 COMPILER V9.01   TRACK                                                                 07/09/2019 13:08:34 PAGE 14  

 768   1                left2=0;
 769   1                right1=1;
 770   1                right2=0;
 771   1                delay_ms(600);
 772   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   8656    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
