C51 COMPILER V9.01   FLAME                                                                 07/09/2019 13:08:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE FLAME
OBJECT MODULE PLACED IN flame.obj
COMPILER INVOKED BY: D:\cx\C51\BIN\C51.EXE flame\flame.c BROWSE DEBUG OBJECTEXTEND PRINT(.\flame.lst) OBJECT(flame.obj)

line level    source

   1          /*********************************************************************************************************
   2          *名称：flame.c
   3          *功能：风扇灭火功能所用到的函数
   4          创建时间：2019/7/8
   5          修改时间：2019/7/8
   6          作者：黄彦钊
   7          *********************************************************************************************************/
   8          
   9          #include <STC12C5A.H>   
  10          #include "pwm/pwm.h"  
  11          #include "delay/delay.h"
  12          #include "config.h"
  13          sbit INT5=P0^0; //电机驱动右边   56xi 接细的蓝色
  14          sbit INT6=P0^1;                                  //白  接细的绿色
  15          sbit INT7=P0^2; //电机驱动左边   //灰 接蓝色
  16          sbit INT8=P0^3;                                  //紫  接橙色
  17          sbit fire=P3^2; //定义火焰传感器的IO口
  18          sbit fire2=P3^3;
  19                  
  20          /*******************************************************************************
  21          * 函 数 名         : Int0Init
  22          * 函数功能                 : 打开外部中断0
  23          *******************************************************************************/
  24          void Int0Init()                                           
  25          {
  26   1              //设置INT0
  27   1              IT0=1;//跳变沿出发方式（下降沿）
  28   1              EX0=1;//打开INT0的中断允许。    
  29   1              EA=1;//打开总中断       
  30   1      }
  31                   
  32          /*******************************************************************************
  33          * 函 数 名         : Int1Init
  34          * 函数功能                 : 打开外部中断1
  35          *******************************************************************************/
  36          void Int1Init()                                   
  37          {
  38   1              //设置INT1
  39   1              IT1=1;//跳变沿出发方式（下降沿）
  40   1              EX1=1;//打开INT1的中断允许。    
  41   1              EA=1;//打开总中断       
  42   1      }
  43               
  44          /*******************************************************************************
  45          * 函 数 名         : fsopen
  46          * 函数功能                 : 开风扇
  47          *******************************************************************************/
  48          void fsopen()   
  49          {               
  50   1              INT7=0;
  51   1              INT6=1;
  52   1      }       
  53            
  54          /*******************************************************************************
  55          * 函 数 名         : fsopen2
C51 COMPILER V9.01   FLAME                                                                 07/09/2019 13:08:33 PAGE 2   

  56          * 函数功能                 : 开风扇方式2
  57          *******************************************************************************/
  58          void fsopen2()
  59          {                  
  60   1              INT7=1;
  61   1              INT8=0;
  62   1      }         
  63                    
  64          /*******************************************************************************
  65          * 函 数 名         : fssto
  66          * 函数功能                 : 风扇停止
  67          *******************************************************************************/
  68          void fsstop()    
  69          {
  70   1              INT7=1;
  71   1              INT6=1;
  72   1      }       
  73                            
  74          /*******************************************************************************
  75          * 函 数 名         : fsstop2
  76          * 函数功能                 : 风扇停止方式2
  77          *******************************************************************************/
  78          void fsstop2()
  79          {
  80   1              INT7=1;
  81   1              INT8=1;
  82   1      }         
  83                    
  84          /*******************************************************************************
  85          * 函 数 名         : Int0
  86          * 函数功能                 : 外部中断0的中断函数
  87          *******************************************************************************/
  88          void Int0() interrupt 0         
  89          {
  90   1              ET0 = 0;
  91   1          TR0 = 0;
  92   1              stop();
  93   1              while(fire==0)             //当火焰传感器检测到火焰
  94   1              {
  95   2                      fsopen();          //开风扇
  96   2                  delay_ms(4500);                        
  97   2              } 
  98   1              delay_ms(2000);
  99   1              while(fire==0)             //当火焰传感器检测到火焰
 100   1              {
 101   2                      fsopen();          //开风扇
 102   2                  delay_ms(4500);                        
 103   2              }
 104   1              fsstop();         //风扇停
 105   1              ET0 = 1;
 106   1          TR0 = 1;
 107   1      }  
 108                    
 109          /*******************************************************************************
 110          * 函 数 名         : Int1
 111          * 函数功能                 : 外部中断1的中断函数
 112          *******************************************************************************/
 113          void Int1()     interrupt 2             
 114          {
 115   1      
 116   1              ET0 = 0;
 117   1          TR0 = 0;
C51 COMPILER V9.01   FLAME                                                                 07/09/2019 13:08:33 PAGE 3   

 118   1              stop();
 119   1              while(fire2==0)
 120   1              {
 121   2                      fsopen2();
 122   2                      delay_ms(4500); 
 123   2              }
 124   1              delay_ms(2000);
 125   1              while(fire2==0)
 126   1              {
 127   2                      fsopen2();
 128   2                      delay_ms(4500); 
 129   2              }
 130   1              fsstop2();
 131   1              ET0 = 1;
 132   1          TR0 = 1;
 133   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    246    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
