C51 COMPILER V9.00   DATA_READ                                                             07/11/2019 20:17:02 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE DATA_READ
OBJECT MODULE PLACED IN data_read.obj
COMPILER INVOKED BY: D:\单片机\C51\BIN\C51.EXE data_read\data_read.c BROWSE DEBUG OBJECTEXTEND PRINT(.\data_read.lst) OB
                    -JECT(data_read.obj)

line level    source

   1          /*********************************************************************************************************
   2          *名称：data_read.c
   3          *功能：读取温湿度以及校验位数据
   4          创建时间：2019/7/10
   5          修改时间：2019/XX/XX
   6          作者：XXX
   7          **********************************************************************************************************
             -/
   8          
   9          #include "data_read.h"
  10          
  11          extern rec_dat[9];
  12          
  13          void DHT11_start()
  14          {
  15   1         Data=1;
  16   1         Delay_us(2);
  17   1         Data=0;
  18   1         Delay_ms(20);   //延时18ms以上
  19   1         Data=1;
  20   1         Delay_us(30);
  21   1      }
  22          
  23          U8 DHT11_rec_byte()     //接收一个字节
  24          {
  25   1              U8 i, dat = 0;
  26   1              for(i=0; i<8; i++)
  27   1              {
  28   2                      while(!Data);
  29   2                      Delay_us(8);
  30   2                      dat <<= 1;
  31   2                      if(Data == 1) dat += 1;
  32   2                      while(Data);
  33   2              }
  34   1              return dat;
  35   1      }
  36          
  37          void DHT11_receive()      //接收40位的数据
  38          {
  39   1          U8 R_H,R_L,T_H,T_L,RH,RL,TH,TL,revise; 
  40   1          DHT11_start();
  41   1          if(Data==0)
  42   1          {
  43   2              while(Data==0);   //等待拉高     
  44   2              Delay_us(40);  //拉高后延时80us
  45   2              R_H=DHT11_rec_byte();    //接收湿度高八位  
  46   2              R_L=DHT11_rec_byte();    //接收湿度低八位  
  47   2              T_H=DHT11_rec_byte();    //接收温度高八位  
  48   2              T_L=DHT11_rec_byte();    //接收温度低八位
  49   2              revise=DHT11_rec_byte(); //接收校正位
  50   2      
  51   2              Delay_us(25);    //结束
  52   2      
  53   2              if((R_H+R_L+T_H+T_L)==revise)      //校正
C51 COMPILER V9.00   DATA_READ                                                             07/11/2019 20:17:02 PAGE 2   

  54   2              {
  55   3                  RH=R_H;
  56   3                  RL=R_L;
  57   3                  TH=T_H;
  58   3                  TL=T_L;
  59   3              } 
  60   2              /*数据处理，方便显示*/
  61   2              rec_dat[0]='0'+(RH/10);
  62   2              rec_dat[1]='0'+(RH%10);
  63   2              rec_dat[2]='R';
  64   2              rec_dat[3]='H';
  65   2              rec_dat[4]=' ';
  66   2              rec_dat[5]=' ';
  67   2              rec_dat[6]='0'+(TH/10);
  68   2              rec_dat[7]='0'+(TH%10);
  69   2              rec_dat[8]='C';
  70   2          }
  71   1      }
  72          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    254    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
