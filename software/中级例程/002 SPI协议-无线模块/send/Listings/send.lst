C51 COMPILER V9.00   SEND                                                                  07/25/2019 20:47:52 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SEND
OBJECT MODULE PLACED IN .\Objects\send.obj
COMPILER INVOKED BY: F:\workApp\Keil_v5\C51\BIN\C51.EXE send\send.c BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\send.lst)
                    - OBJECT(.\Objects\send.obj)

line level    source

   1          /*********************************************************************************************************
   2          *Ãû³Æ£ºsende.c
   3          *¹¦ÄÜ£ºspi¡ª¡ªÎÞÏßÄ£¿éµÄ¶¨Òå¼°·¢ËÍº¯Êý
   4          ´´½¨Ê±¼ä£º2019/7/8
   5          ÐÞ¸ÄÊ±¼ä£º2019/7/11
   6          ×÷Õß£º»ÆÑåîÈ
   7          *********************************************************************************************************/
   8          #include"send.h"
   9          //1//sbit KEY1=P0^0;                    //·¢ËÍ°´¼ü 
  10          //1//sbit KEY2=P0^1;
  11          //1//sbit KEY3=P0^2;
  12          //1//sbit KEY4=P0^3;
  13          sbit beep=P2^3;                                 //À®°È 
  14          sbit LED6=P1^6;                                 //·¢ËÍÊý¾ÝÊ±ÏÔÊ¾µÆ+½ÓÊÕµ½Êý¾ÝºóµÄ¹¦ÄÜÊµÏÖµÆ
  15          
  16          uchar Tx_Buf1[]={1};                    //·¢ËÍµÄÐÅÏ¢1 
  17          uchar Rx_Buf[32];                               //½ÓÊÕµ½µÄÊý¾ÝÔÝ´æÆ÷£¬×î¶à32×Ö½ÚÊý¾Ý                      
  18                                           
  19          uchar uart_flag,a;                      //´®¿Ú½ÓÊÕ±êÖ¾¡¾ÊÕµ½Êý¾Ý¾ÍÖÃ1¡¿,aÎª½ÓÊÕµ½µÄÊý¾Ý
  20          
  21          /*******************************************************************************
  22          * º¯ Êý Ãû         : run
  23          * º¯Êý¹¦ÄÜ                 : Ö÷º¯ÊýÔËÐÐ
  24          *******************************************************************************/ 
  25          void run()
  26          {
  27   1               LED6=1;                                //³õÊ¼µÆ6Ï¨Ãð   
  28   1               uart_flag=0;                   //´®¿Ú±êÖ¾³õÊ¼Îª0
  29   1               init_NRF24L01();               //³õÊ¼»¯24L01
  30   1               UART_Init();           //³õÊ¼»¯´®¿Ú
  31   1      
  32   1               while(NRF24L01_Check())                                        //¼ì²é²»µ½24l01Ôò±¨¾¯ 
  33   1               {
  34   2                      beep=0;
  35   2                      delay_ms(200);
  36   2                      beep=1;
  37   2                      delay_ms(200);
  38   2               }
  39   1               while(1)
  40   1               {      
  41   2                      RX_Mode();                                                      //½ÓÊÕÄ£Ê½  
  42   2                      while(!nRF24L01_RxPacket(Rx_Buf))       //µÈ´ý½ÓÊÕÊý¾Ý,·µ»Ø1Ôò½ÓÊÕµ½Êý¾Ý,ÔÚµÈ´ý½ÓÊÕÊý¾ÝÆÚ¼ä,¿ÉÒÔËæÊ±±ä³É·¢ËÍÄ
             -£Ê½  
  43   2                  {
  44   3                              if(uart_flag==1)                                //µ±´®¿Ú½ÓÊÜ±êÖ¾Îª1±íÊ¾ÓÐÊý¾Ý¹ýÀ´
  45   3                              {
  46   4                                      ES=0;                                                   //¹Ø´®¿ÚÖÐ¶Ï
  47   4                              
  48   4                                      TX_Mode();                                              //·¢ËÍÄ£Ê½ 
  49   4                                      Tx_Buf1[0]=a-'0';                                       //½«´®¿ÚÊý¾Ý¸ø·¢ËÍ»º³åÇø
  50   4                                  nRF24L01_TxPacket(Tx_Buf1);         //·¢ËÍÃüÁîÊý¾Ý24L01
  51   4                                      UART_Send_Byte('O');                    //Ïò´®¿Ú·¢ËÍÒÑ¾­´«ËÍ
  52   4                                      UART_Send_Byte('K');
  53   4                                      UART_Send_Byte(':');
C51 COMPILER V9.00   SEND                                                                  07/25/2019 20:47:52 PAGE 2   

  54   4                                      UART_Send_Byte(a);
  55   4                                      UART_Send_Byte('\n');
  56   4                                      LED6=0;
  57   4                                  delay_ms(300);
  58   4                                      LED6=1;
  59   4                                  delay_ms(300);                                      //·¢ËÍºóLED1ÉÁÒ»ÏÂ 
  60   4      
  61   4                                      ES=1;                                                   //ÔÊÐí´®¿ÚÖÐ¶Ï
  62   4                                      uart_flag=0;                                    //ÖÐ¶Ï±êÖ¾Î»ÖÃ0
  63   4                                      break;                                                  //ÍË³ö×î½üµÄÑ­»·,´Ó¶ø±ä»Ø½ÓÊÕÄ£Ê½,Õâ¾ä¹Ø¼ü
  64   4                              }
  65   3                       }
  66   2                       if(Rx_Buf[0]==1)                                                       //Èô½ÓÊÕµ½¶ÔÓ¦µÄÊý¾ÝÔòÊµÏÖ¶ÔÓ¦¹¦ÄÜ 
  67   2                       {
  68   3                           Rx_Buf[0]=0;                               //Çå¿ÕÊý¾Ý 
  69   3                           LED6=0;
  70   3                               delay_ms(300);
  71   3                               LED6=1;
  72   3                               delay_ms(300);                         //½ÓÊÕµ½Êý¾Ý ºóÉÁË¸       
  73   3                       }
  74   2               }
  75   1      }
  76                                                            
  77          /*------------------------------------------------
  78          ´®¿Ú½ÓÊÕÖÐ¶Ï·þÎñ³ÌÐò
  79          ------------------------------------------------*/
  80          void UART() interrupt 4
  81          {
  82   1              if(RI)                          //¼ì²â½ÓÊÕÍê³É±êÖ¾Î»ÖÃ1
  83   1              {
  84   2                      RI=0;                   //ÇåÁã½ÓÊÕÍê³É±êÖ¾Î»
  85   2                      a=SBUF;                 //¶ÁÈ¡½ÓÊÕµ½µÄÊý¾Ý
  86   2                      uart_flag = 1;  //ÖÐ¶Ï±êÖ¾Î»ÖÃ1
  87   2              }
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    165    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     35    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
