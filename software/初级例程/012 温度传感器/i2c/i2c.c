/*********************************************************************************************************
*名称：i2c.c
*功能：IO口模拟I2C通信
创建时间：2019/7/14
修改时间：2019/7/30
作者：黄彦钊
**********************************************************************************************************/

#include "i2c.h"

/*******************************************************************************
* 函 数 名         : IIC_Start
* 函数功能		   : i2c开始信号
*******************************************************************************/

void IIC_Start()
{
	SDA = high;
	nop(1);
	SCL = high;
	nop(1);
	SDA = low;
	nop(1);
	SCL = low;
	nop(1);
}

/*******************************************************************************
* 函 数 名         : IIC_Stop
* 函数功能		   : i2c终止信号
*******************************************************************************/

void IIC_Stop()
{
	SCL = low;
	nop(1);
	SDA = low;
	nop(1);
	SCL = high;
	nop(1);
	SDA = high;
	nop(1);
}


/*******************************************************************************
* 函 数 名         : Write_IIC_Byte
* 函数功能		   : 通过I2C总线写一个字节
*******************************************************************************/

void Write_IIC_Byte(uchar IIC_Byte)
{
	uchar i;

	for(i=0;i<8;i++)
	{
		if(IIC_Byte & 0x80)
			SDA=high;
		else
			SDA=low;

		SCL=high;

		SCL=low;

		IIC_Byte<<=1;
	}
	SDA=low;
	SCL=high;
	SCL=low;
}