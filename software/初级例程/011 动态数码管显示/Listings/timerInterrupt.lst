C51 COMPILER V9.00   TIMERINTERRUPT                                                        08/30/2019 17:42:58 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMERINTERRUPT
OBJECT MODULE PLACED IN .\Objects\timerInterrupt.obj
COMPILER INVOKED BY: F:\workApp\Keil_v5\C51\BIN\C51.EXE timerInterrupt\timerInterrupt.c BROWSE DEBUG OBJECTEXTEND PRINT(
                    -.\Listings\timerInterrupt.lst) OBJECT(.\Objects\timerInterrupt.obj)

line level    source

   1          /*********************************************************************************************************
   2          *名称：timerInterrupt.c
   3          *功能：定时中断对应的函数
   4          创建时间：2019/7/5
   5          修改时间：2019/7/5
   6          作者：黄彦钊
   7          ********************************************************************************************************/
   8          #include "timerInterrupt.h"     
   9          #include "config.h"                     
  10          #include "display/display.h"
  11          uint i = 1234;
  12          uint j = 0;
  13          /*********************************************************************************************************
  14          ** TMOD是八位定时器/计数器模式控制寄存器（TIMER/COUNTER MODE CONTROL REGISTER），其中低四位定义定时器/计数
             -器T0,高四位定义定时器/计数器T1
  15          **
  16          ** 配置定时器0模式（即配置低四位）：|GATE           |  C/T                  |    M1 | M0                                  |
  17          **                                                       0                     0      设置为定时模式     0    0         13位定时模式
  18          **                                       1 要求INT0脚为高  1      设置为计数模式     0    1             16位定时模式
  19          **                                                                                               1    0         8位自动装载模式
  20          **
  21          ** 配置定时器1模式（即配置高四位）： |GATE           |  C/T                  |    M1 | M0                                 |
  22          **                                                       0                     0      设置为定时模式     0    0         13位定时模式
  23          **                                       1 要求INT0脚为高  1      设置为计数模式     0    1             16位定时模式
  24          **                                                                                               1    0         8位自动装载模式
  25          ** 详细的介绍请参看文档STC12C5A60S2.pdf中定时器计数器的章节
  26          ** 本例程采用16位定时模式，TH0,TL0全用
  27          *********************************************************************************************************/
  28          
  29          
  30          /*******************************************************************************************************
  31          **函数：init
  32          **功能：定时器0初始化
  33          **********************************************************************************************************
             -*/
  34          void init()
  35          {
  36   1        TMOD = 0X01;  //设置定时器的工作方式                                             
  37   1              TH0 = (65536-FSCLK/12/20)/256;   //配置定时器的高8位
  38   1              TL0 = (65536-FSCLK/12/20)%256;   //配置定时器的低8位
  39   1              ET0 = 1;                                         //允许定时器0中断
  40   1              EA = 1;                                          //打开总中断EA和ET0、TR0全部置1后，如果计数器计数溢出就马上执行中断处理函数void time0() int
             -errupt 1 
  41   1              TR0 = 1;                                         //打开定时器，开始计数
  42   1      }
  43          
  44                  
  45          /*******************************************************************************
  46          * 函 数 名         : timer0
  47          * 函数功能                 : 定时器0程序
  48                                                   实现2秒定时，即每2秒就执行一次if里面的程序语句
  49          *******************************************************************************/ 
  50          
  51          void timer0() interrupt 1
C51 COMPILER V9.00   TIMERINTERRUPT                                                        08/30/2019 17:42:58 PAGE 2   

  52          {                                       
  53   1              TH0 = (65536-FSCLK/12/20)/256; //每一次进入中断都要给定时器赋值，以确定下一次进入中断的时间
  54   1              TL0 = (65536-FSCLK/12/20)%256;
  55   1              j++;    
  56   1              if(j==20)
  57   1              {
  58   2                      j=0;    
  59   2                      display(i++);
  60   2              }                  
  61   1      }
  62          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    111    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
