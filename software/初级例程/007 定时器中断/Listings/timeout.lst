C51 COMPILER V9.01   TIMEOUT                                                               07/05/2019 11:41:02 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE TIMEOUT
OBJECT MODULE PLACED IN timeout.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE timeout\timeout.c BROWSE DEBUG OBJECTEXTEND PRINT(.\timeout.lst) OBJECT(tim
                    -eout.obj)

line level    source

   1          /*********************************************************************************************************
   2          *Ãû³Æ£ºtimeout.c
   3          *¹¦ÄÜ£º¶¨Ê±ÖÐ¶Ï¶ÔÓ¦µÄº¯Êý
   4          ´´½¨Ê±¼ä£º2019/7/5
   5          ÐÞ¸ÄÊ±¼ä£º2019/7/5
   6          ×÷Õß£º»Æ½£ÇÅ
   7          ********************************************************************************************************/
   8          #include "timeout.h"
   9           U16 time=0;
  10           U16 flag=0;
  11          /*********************************************************************************************************
  12          ** TMODÊÇ°ËÎ»¶¨Ê±Æ÷/¼ÆÊýÆ÷Ä£Ê½¿ØÖÆ¼Ä´æÆ÷£¨TIMER/COUNTER MODE CONTROL REGISTER£©£¬ÆäÖÐµÍËÄÎ»¶¨Òå¶¨Ê±Æ÷/¼ÆÊý
             -Æ÷T0,¸ßËÄÎ»¶¨Òå¶¨Ê±Æ÷/¼ÆÊýÆ÷T1
  13          **
  14          ** ÅäÖÃ¶¨Ê±Æ÷0Ä£Ê½£¨¼´ÅäÖÃµÍËÄÎ»£©£º|GATE           |  C/T                  |    M1 | M0                                  |
  15          **                                                       0                     0      ÉèÖÃÎª¶¨Ê±Ä£Ê½     0    0         13Î»¶¨Ê±Ä£Ê½
  16          **                                       1 ÒªÇóINT0½ÅÎª¸ß  1      ÉèÖÃÎª¼ÆÊýÄ£Ê½     0    1             16Î»¶¨Ê±Ä£Ê½
  17          **                                                                                               1    0         8Î»×Ô¶¯×°ÔØÄ£Ê½
  18          **
  19          ** ÅäÖÃ¶¨Ê±Æ÷1Ä£Ê½£¨¼´ÅäÖÃ¸ßËÄÎ»£©£º |GATE           |  C/T                  |    M1 | M0                                 |
  20          **                                                       0                     0      ÉèÖÃÎª¶¨Ê±Ä£Ê½     0    0         13Î»¶¨Ê±Ä£Ê½
  21          **                                       1 ÒªÇóINT0½ÅÎª¸ß  1      ÉèÖÃÎª¼ÆÊýÄ£Ê½     0    1             16Î»¶¨Ê±Ä£Ê½
  22          **                                                                                               1    0         8Î»×Ô¶¯×°ÔØÄ£Ê½
  23          ** ÏêÏ¸µÄ½éÉÜÇë²Î¿´ÎÄµµSTC12C5A60S2.pdfÖÐ¶¨Ê±Æ÷¼ÆÊýÆ÷µÄÕÂ½Ú
  24          ** ±¾Àý³Ì²ÉÓÃ16Î»¶¨Ê±Ä£Ê½£¬TH0,TL0È«ÓÃ
  25          *********************************************************************************************************/
  26          
  27          
  28          /*******************************************************************************************************
  29          **º¯Êý£ºInt0
  30          **¹¦ÄÜ£º¿ØÖÆÖÐ¶ÏºóÊµÏÖµÄ¹¦ÄÜ
  31          **********************************************************************************************************
             -*/
  32          void Int0()
  33          {
  34   1        TMOD = 0X01;  //ÉèÖÃ¶¨Ê±Æ÷µÄ¹¤×÷·½Ê½     
  35   1      /*********************************************************************************************************
  36   1      **      ¶¨Ê±Æ÷³õÖµÉèÖÃ£ºÏÈ¼ÆËã¶¨Ê±Æ÷¼ÆÊýµÄËÙ¶È£¬¼´¼ÆÒ»¸öÊýËùÓÃµÄÊ±¼äÎªt = 1/FSCLK*12 (µ¥Î»£ºs) £¬FSCLKÊÇµ¥Æ¬»ú
             -ÏµÍ³Ê±ÖÓµÄÆµÂÊ
  37   1      **                                      ¶¨Ê±Æ÷0Ä£Ê½ÉèÖÃÎª16Î»£¬×î¶à¼ÆÊýµ½65535ÔÙ¼Ó1ºóÒç³ö¹é0
  38   1      **                                      ÈÃ¶¨Ê±Æ÷0¶¨Ê±50ms£¬Ôò¼ÆÊýÆ÷Ó¦¸Ã¼ÆÊý¸öÊýnumÓ¦Âú×ãnum*t=0.05£¬¼´num = 1/t*0.1 = FSCLK/12/20
  39   1      **                                      ¶¨Ê±Æ÷ÊÇ¼Óµ½65535ÔÙ¼Ó1²ÅÒç³öµÄ£¬ÒªÈÃ¶¨Ê±Æ÷0¶¨Ê±50ms,¹Ê³õÖµÓ¦ÉèÖÃÎª65536-FSCLK/12/20
  40   1      **********************************************************************************************************
             -/                                                   
  41   1              TH0 = (65536-FSCLK/12/20)/256;   //ÅäÖÃ¶¨Ê±Æ÷µÄ¸ß8Î»
  42   1              TL0 = (65536-FSCLK/12/20)%256;   //ÅäÖÃ¶¨Ê±Æ÷µÄµÍ8Î»
  43   1              ET0 = 1;                                         //ÔÊÐí¶¨Ê±Æ÷0ÖÐ¶Ï
  44   1              EA = 1;                                          //´ò¿ª×ÜÖÐ¶ÏEAºÍET0¡¢TR0È«²¿ÖÃ1ºó£¬Èç¹û¼ÆÊýÆ÷¼ÆÊýÒç³ö¾ÍÂíÉÏÖ´ÐÐÖÐ¶Ï´¦Àíº¯Êývoid time0() int
             -errupt 1 
  45   1              TR0 = 1;                                         //´ò¿ª¶¨Ê±Æ÷£¬¿ªÊ¼¼ÆÊý
  46   1              while(1)
  47   1              {
  48   2                      if(flag != 0)                   //±êÖ¾Î»flagÖÃ1
  49   2                      {
C51 COMPILER V9.01   TIMEOUT                                                               07/05/2019 11:41:02 PAGE 2   

  50   3                              flag = 0;                       //ÖÃ0±êÖ¾Î»£¬Ê¹Ö®ºó½øÈëwhile(1)Ñ­»·µÄÊ±ºò£¬³ý·ÇÖÐ¶Ï´¦Àíº¯Êý°ÑflagÖÃ1£¬·ñÔòifÀïÃæµÄ³ÌÐòÓï¾ä²
             -»»áÖ´ÐÐ
  51   3                                                       //ÔÙÏÔÊ¾1
  52   3                      }                                          
  53   2              }
  54   1      }
  55          
  56          
  57          
  58          void time0() interrupt 1
  59          {
  60   1              TH0 = (65536-FSCLK/12/20)/256; //Ã¿Ò»´Î½øÈëÖÐ¶Ï¶¼Òª¸ø¶¨Ê±Æ÷¸³Öµ£¬ÒÔÈ·¶¨ÏÂÒ»´Î½øÈëÖÐ¶ÏµÄÊ±¼ä
  61   1              TL0 = (65536-FSCLK/12/20)%256;
  62   1              time ++;
  63   1              if(time ==40)                            //Ã¿100ms½øÈëÒ»´ÎÖÐ¶Ï£¬t = 50*40 ms =2s¡£ÊµÏÖ2Ãë¶¨Ê±£¬¼´2Ãë¾ÍÖ´ÐÐifÀïÃæµÄ³ÌÐòÓï¾ä
  64   1              {
  65   2                      time = 0;
  66   2                      flag = 1;
  67   2                      buzz=~buzz;
  68   2      
  69   2              }               
  70   1      }
  71          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     64    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
